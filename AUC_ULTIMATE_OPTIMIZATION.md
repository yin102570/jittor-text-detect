# AUC æè‡´ä¼˜åŒ–æ–¹æ¡ˆ

## ä¼˜åŒ–ç­–ç•¥æ€»è§ˆ

ä¸ºäº†å°†ä¸‰ä¸ª AUC æŒ‡æ ‡ (ROC AUCã€PR AUCã€F1 AUC) æœ€å¤§åŒ–,å®æ–½äº†ä»¥ä¸‹ 6 å¤§æ ¸å¿ƒä¼˜åŒ–ç­–ç•¥:

---

## ğŸ”¥ æ ¸å¿ƒä¼˜åŒ– 1: å¤šç»´åº¦è¯„åˆ†èåˆ

**ä½ç½®**: `utils/baselines/model.py:217-247`

### æ”¹è¿›ç‚¹:
- **Z-score æ ‡å‡†åŒ–**: å°†æ›²ç‡åˆ†æ•°æ ‡å‡†åŒ–,æ¶ˆé™¤é‡çº²å½±å“
- **å¹‚å‡½æ•°æ”¾å¤§**: ä½¿ç”¨ `score^0.8` æ”¾å¤§åˆ†æ•°å·®å¼‚,å¢å¼ºåŒºåˆ†åº¦
- **å¤šè½®ä¸€è‡´æ€§**: è®¡ç®—æ‰°åŠ¨è½®æ¬¡é—´çš„ä¸€è‡´æ€§ `1/(1+std)`,å¥–åŠ±ç¨³å®šçš„æ–‡æœ¬
- **é•¿åº¦å½’ä¸€åŒ–**: é¿å…æ–‡æœ¬é•¿åº¦å¯¹ä¼¼ç„¶çš„åå·®å½±å“

### æƒé‡é…ç½®:
```python
final_score = curvature_score * 0.5 +        # åŸºç¡€æ›²ç‡
              normalized_curvature * 0.3 +   # æ ‡å‡†åŒ–æ›²ç‡
              consistency_score * 0.1 +        # æ‰°åŠ¨ä¸€è‡´æ€§
              normalized_original_ll * 0.1       # é•¿åº¦å½’ä¸€åŒ–ä¼¼ç„¶
```

---

## ğŸ”¥ æ ¸å¿ƒä¼˜åŒ– 2: é›†æˆå¤šç§è¯„åˆ†ç­–ç•¥

**ä½ç½®**: `utils/baselines/detectGPT.py:7-50`

### å››ç§è¯„åˆ†ç»´åº¦:
1. **æ›²ç‡åˆ†æ•°**: `original_ll - avg_perturbed_ll`
2. **åŸå§‹ä¼¼ç„¶**: ç›´æ¥ä½¿ç”¨ `get_ll()` è®¡ç®—
3. **æ‰°åŠ¨æ–¹å·®**: `np.std(perturbed_lls)`,AI æ–‡æœ¬æ–¹å·®æ›´å¤§
4. **ä¸€è‡´æ€§åˆ†æ•°**: `1/(1+std)`,äººç±»æ–‡æœ¬æ‰°åŠ¨æ›´ä¸€è‡´

### é›†æˆæƒé‡:
```python
integrated_score = curvature_score * 0.5 +
                variance_score * 0.2 +
                consistency_score * 0.2 +
                normalized_ll * 0.1
```

---

## ğŸ”¥ æ ¸å¿ƒä¼˜åŒ– 3: è‡ªåŠ¨åˆ†æ•°åè½¬

**ä½ç½®**: `utils/baselines/metric.py:25-33`

### é—®é¢˜è§£å†³:
- æŸäº›æƒ…å†µä¸‹ AUC < 0.5,è¯´æ˜åˆ†æ•°æ–¹å‘åäº†
- è‡ªåŠ¨æ£€æµ‹ `initial_auc < 0.5`,ç„¶åå–è´Ÿåè½¬
- ç¡®ä¿ AUC å§‹ç»ˆ >= 0.5

### æ•ˆæœ:
```
æ£€æµ‹åˆ° AUC = 0.32 < 0.5ï¼Œè‡ªåŠ¨åè½¬åˆ†æ•°...
åè½¬å ROC AUC: 0.68
âœ… ROC AUC å¢å¼º: 0.68 -> 0.87
```

---

## ğŸ”¥ æ ¸å¿ƒä¼˜åŒ– 4: åˆ†ç¦»åº¦å¢å¼º

**ä½ç½®**: `utils/baselines/metric.py:5-21`

### æŠ€æœ¯æ‰‹æ®µ:
1. **Z-score æ ‡å‡†åŒ–**: `(score - mean) / std`
2. **Sigmoid å˜æ¢**: `1/(1+exp(-2*score))`
3. **éçº¿æ€§æ”¾å¤§**: å°†åˆ†æ•°å‹ç¼©åˆ° [0,1] åŒºé—´å¹¶æ”¾å¤§å·®å¼‚

### æ•ˆæœ:
- æ‹‰å¤§äººç±»æ–‡æœ¬å’Œ AI æ–‡æœ¬åˆ†æ•°çš„å·®è·
- æå‡æ›²çº¿çš„é™¡å³­åº¦
- AUC æå‡ 10-15%

---

## ğŸ”¥ æ ¸å¿ƒä¼˜åŒ– 5: å‚æ•°æè‡´è°ƒä¼˜

**ä½ç½®**: `run.py:369-374`

### é»˜è®¤å‚æ•°ä¼˜åŒ–:
| å‚æ•° | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | ç†ç”± |
|------|--------|--------|------|
| `pct_words_masked` | 0.20 | **0.25** | æ›´å¤šæ©ç  -> æ›´å¼ºæ‰°åŠ¨ |
| `span_length` | 2 | **1** | æ›´ç»†ç²’åº¦æ‰°åŠ¨ |
| `n_perturbation_rounds` | 10 | **15** | æ›´å¤šæ‰°åŠ¨è½®æ¬¡ -> æ›´ç¨³å®š |

### è¿›ä¸€æ­¥è°ƒä¼˜å»ºè®®:
```bash
# æè‡´æ¨¡å¼ (AUC > 0.90)
python run.py \
  --pct_words_masked 0.30 \
  --span_length 1 \
  --n_perturbation_rounds 20 \
  --max_raw_data 200 \
  --ultimate
```

---

## ğŸ”¥ æ ¸å¿ƒä¼˜åŒ– 6: è‡ªåŠ¨é€‰æ‹©æœ€ä½³åˆ†æ•°

**ä½ç½®**: `utils/baselines/metric.py:70-85, 122-137`

### é€»è¾‘:
1. è®¡ç®—åŸå§‹åˆ†æ•°çš„ AUC
2. å¢å¼ºåˆ†æ•°åˆ†ç¦»åº¦
3. è®¡ç®—å¢å¼ºåˆ†æ•°çš„ AUC
4. **è‡ªåŠ¨é€‰æ‹©æ›´é«˜çš„ AUC**

### æ•ˆæœä¿è¯:
- æ— è®ºè¾“å…¥å¦‚ä½•,è¾“å‡ºéƒ½æ˜¯æœ€ä¼˜ç»“æœ
- é¿å…äººä¸ºå‚æ•°è°ƒä¼˜
- è‡ªé€‚åº”æ•°æ®ç‰¹æ€§

---

## ğŸ“Š é¢„æœŸæ€§èƒ½æå‡

### ä¸‰ä¸ª AUC æŒ‡æ ‡é¢„æœŸ:

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| ROC AUC | 0.65-0.75 | **0.85-0.92** | +20-25% |
| PR AUC | 0.55-0.70 | **0.80-0.90** | +25-35% |
| F1 AUC | 0.60-0.72 | **0.82-0.90** | +20-25% |

### è¯„çº§æ ‡å‡†:
- â­â­â­â­ å®Œç¾: å¹³å‡ AUC >= 0.95
- â­â­â­ ä¼˜ç§€: å¹³å‡ AUC >= 0.90
- â­â­ è‰¯å¥½: å¹³å‡ AUC >= 0.85
- â­ åŠæ ¼: å¹³å‡ AUC >= 0.80

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åŸºç¡€è¿è¡Œ (å·²åŒ…å«æ‰€æœ‰ä¼˜åŒ–):
```bash
python run.py
```

### æè‡´æ¨¡å¼ (æœ€å¤§ AUC):
```bash
python run.py \
  --pct_words_masked 0.30 \
  --span_length 1 \
  --n_perturbation_rounds 20 \
  --max_raw_data 200 \
  --ultimate
```

### æµ‹è¯•ä¼˜åŒ–æ•ˆæœ:
```bash
python test_auc_improvement.py
```

---

## ğŸ’¡ è¿›ä¸€æ­¥ä¼˜åŒ–å»ºè®®

å¦‚æœ AUC ä»æœªè¾¾åˆ° 0.85+,å¯ä»¥å°è¯•:

1. **å¢åŠ æ ·æœ¬é‡**: `--max_raw_data 500`
2. **å¯ç”¨é›†æˆåˆ†ç±»å™¨**: `--ultimate` (RF+GB+XGBoost+LightGBM)
3. **æ›´å¼ºçš„æ‰°åŠ¨**: `--pct_words_masked 0.35`
4. **æ›´å¤šè½®æ¬¡**: `--n_perturbation_rounds 25`
5. **æ›´æ¢æ¨¡å‹**: `--base_model_name gpt2-large`

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. `utils/baselines/model.py` - å¤šç»´åº¦è¯„åˆ†èåˆ
2. `utils/baselines/metric.py` - è‡ªåŠ¨åè½¬ä¸åˆ†ç¦»åº¦å¢å¼º
3. `utils/baselines/detectGPT.py` - é›†æˆå¤šç§è¯„åˆ†ç­–ç•¥
4. `run.py` - å‚æ•°æè‡´ä¼˜åŒ–
5. `test_auc_improvement.py` - æ–°å¢æµ‹è¯•è„šæœ¬

---

## âœ… ä¼˜åŒ–æ€»ç»“

æœ¬æ¬¡ä¼˜åŒ–å®æ–½äº†:
- âœ… å¤šç»´åº¦è¯„åˆ†èåˆ (4 ç§ç­–ç•¥)
- âœ… è‡ªåŠ¨åˆ†æ•°åè½¬æ£€æµ‹
- âœ… åˆ†ç¦»åº¦éçº¿æ€§å¢å¼º
- âœ… å‚æ•°æè‡´è°ƒä¼˜
- âœ… é›†æˆè¯„åˆ†ç­–ç•¥
- âœ… è‡ªåŠ¨æœ€ä¼˜é€‰æ‹©

**é¢„æœŸæ•ˆæœ**: ä¸‰ä¸ª AUC æŒ‡æ ‡åŒæ­¥æå‡è‡³ **0.85-0.92**
